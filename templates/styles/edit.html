{% extends "base.html" %}

{% block extrahead %}{{ block.super }}
    <script type='application/javascript'>
        function addprice(){
            var priceprefix = parseInt($('#id_pricecount').val()) + 1;
            $.get('/tsd/styles/addprice/', {'prefix':priceprefix}, function(data){
                $('#pricecategories').append(data);
                $('#id_pricecount').val(priceprefix);
            });
        }
        
        function addaddedcost(parentprefix){
            var addedcostprefix = parseInt($('#id_pricecount').val()) + 1;
            $.get('/tsd/styles/addaddedcost/', {'prefix':addedcostprefix, 'parentprefix':parentprefix}, function(data){
                $('#' + parentprefix + 'prices').append(data);
                $('#id_addedcostcount').val(addedcostprefix);
                $('#sizes input:checked').each(function(index){
                    var sizeprefix = $(this).parent().data('prefix');
                    var sizename = $('#id_' + sizeprefix + '-label').val();
                    alert($('#id_' + addedcostprefix + '-sizeprefix').val());
                    $('#id_' + addedcostprefix + '-sizeprefix').addOption(sizeprefix, sizename);
                    //.append("<option value='" + sizeprefix + "'>" + sizename + "</option>");
                });
            });
        }
    </script>

    <style type='text/css'>

    </style>
{% endblock %}

{% block content %}
    <form method="post" action="">
    {% csrf_token %}
        <fieldset>
            <legend>Meta</legend>
            {% for field in form.hidden_fields %}{{ field }}{% endfor %}
            {{ form.errors }}
            <table>
                <tr>
                    <td>{{ form.number.label }}</td>
                    <td class='{{ form.number.css_classes }}'>{{ form.number }}</td>
                </tr>
                <tr>
                    <td>{{ form.description.label }}</td>
                    <td>{{ form.description }}</td>
                </tr>
                <tr>
                    <td>{{ form.manufacturer.label }}</td>
                    <td>{{ form.manufacturer }}</td>
                </tr>
            </table>
        </fieldset>
        
        <fieldset>
            <legend>Sizes Available</legend>
            <table id='sizes'>
                <tr>
                    <th></th>
                    <th>Size</th>
                    <th>Weight</th>
                </tr>
                {% for sizeform in sizeforms %}
                <tr>
                    <td data-prefix='{{ sizeform.prefix }}'>{{ sizeform.exists }}{{ sizeform.errors }}</td>
                    <td>{{ sizeform.label.value }}</td>
                    <td>{{ sizeform.weight }}{% for field in sizeform.hidden_fields %}{{ field }}{% endfor %}</td>
                </tr>
                {% endfor %}
            </table>
        </fieldset>
        
        <h3>Price Categories <input type='button' value='+' onClick='addprice();'/></h3>
        <div id='pricecategories'>
        {% for priceform in priceforms %}
            {% include 'styles/price.html' %}
        {% endfor %}
        </div>
        
        <fieldset>
            <legend>Notes</legend>
            {{ form.note }}
        </fieldset>
        <input type='submit' value='submit'/>
    </form>
{% endblock %}

{% block sidebar %}
    <ul>
    {% for color in colors %}
        <li>{{ color }}</li>
    {% endfor %}
    </ul>
{% endblock %}
